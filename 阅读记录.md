serialPortConfig_t 定义一个存放串口设置参数的结构体
serialPortFunction_e 一个枚举类型，串口函数？

# 11月15日记录

## 开发环境
1. x86_64 linux arm-none-eabi, 这个编译工具链在用make编译代码的时候会自动下载到tools文件夹，不用自己下载安装。用
```
arm-none-eabi-gcc -v
arm-none-eabi-gbd -v
```
检查有没有添加路径，没有的话在 .bashrc 文件中添加，例如
```
export PATH=/home/solaris/codes/inav/tools/gcc-arm-none-eabi-10.3-2021.10/bin/:$PATH
```
gdb运行可能缺少libncurses.so.5
参考[这个帖子](https://huaweicloud.csdn.net/6356695ad3efff3090b5e439.html)

2. openocd
apt-get方式下载或者源码编译安装都可

## 编译方法
首次编译
```
cd inav
mkdir build
cd build
cmake ..
make -j SPEEDYBEEF405V3
```
再次编译
```
cd build
make clean //可选
make -j SPEEDYBEEF405V3
```

## 下载和调试
### 用地面站下载
注意要开启相应端口的权限,例如
```
sudo chmod 777 /dev/ttyACM0 //临时打开串口权限
sudo usermod -aG dialout solaris//永久打开串口权限，重启生效
```


### openocd指令
连接好板子和stlink
```
// 运行openocd
openocd -f interface/stlink.cfg -f target/stm32f4x.cfg

//另开一个端口，烧录程序
telnet localhost 4444

reset init
flash write_image erase [filepath]
reset
```
## 开启数传

启用FEATURE_TELEMETRY，数传协议暂时只能用MAVLink，搭配MissionPlanner使用，其他的不输出数据

## 输出并保存配置
```
diff all //自行复制
```

## 向调度器中添加任务


## 现有的问题
1. 地面站进入cli模式后会清除msp的通信端口，所以LOG信息不能发送出来，这是程序的bug，暂时不能通过这种方式调试


